# API –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ NailMasters

## üîê –û–±–∑–æ—Ä

–°–∏—Å—Ç–µ–º–∞ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ –æ—Å–Ω–æ–≤–∞–Ω–∞ –Ω–∞ JWT —Ç–æ–∫–µ–Ω–∞—Ö —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π refresh —Ç–æ–∫–µ–Ω–æ–≤ –¥–ª—è –±–µ–∑–æ–ø–∞—Å–Ω–æ–≥–æ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Å–µ—Å—Å–∏–π.

## üìã Endpoints

### 1. –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

**POST** `/api/auth/register`

–°–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤–æ–≥–æ –∞–∫–∫–∞—É–Ω—Ç–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.

#### –¢–µ–ª–æ –∑–∞–ø—Ä–æ—Å–∞:
```json
{
  "email": "user@example.com",
  "password": "securePassword123",
  "name": "–ò–º—è –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è",
  "phone": "+7 (999) 123-45-67",
  "type": "client", // –∏–ª–∏ "master"
  "location": "–ú–æ—Å–∫–≤–∞", // –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ
  "specialties": ["–ì–µ–ª—å-–ª–∞–∫", "–î–∏–∑–∞–π–Ω"] // —Ç–æ–ª—å–∫–æ –¥–ª—è –º–∞—Å—Ç–µ—Ä–æ–≤
}
```

#### –£—Å–ø–µ—à–Ω—ã–π –æ—Ç–≤–µ—Ç (201):
```json
{
  "message": "–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —É—Å–ø–µ—à–Ω–æ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω",
  "user": {
    "id": "uuid",
    "email": "user@example.com",
    "name": "–ò–º—è –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è",
    "phone": "+7 (999) 123-45-67",
    "type": "client",
    "location": "–ú–æ—Å–∫–≤–∞",
    "is_active": true,
    "email_verified": false,
    "created_at": "2024-01-01T00:00:00.000Z"
  },
  "tokens": {
    "accessToken": "eyJhbGciOiJIUzI1NiIs...",
    "refreshToken": "eyJhbGciOiJIUzI1NiIs..."
  },
  "success": true
}
```

#### –û—à–∏–±–∫–∏:
- **400** - –ù–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
- **409** - –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —É–∂–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç

---

### 2. –í—Ö–æ–¥ –≤ —Å–∏—Å—Ç–µ–º—É

**POST** `/api/auth/login`

–ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.

#### –¢–µ–ª–æ –∑–∞–ø—Ä–æ—Å–∞:
```json
{
  "email": "user@example.com",
  "password": "securePassword123"
}
```

#### –£—Å–ø–µ—à–Ω—ã–π –æ—Ç–≤–µ—Ç (200):
```json
{
  "message": "–£—Å–ø–µ—à–Ω—ã–π –≤—Ö–æ–¥ –≤ —Å–∏—Å—Ç–µ–º—É",
  "user": {
    "id": "uuid",
    "email": "user@example.com",
    "name": "–ò–º—è –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è",
    "type": "client",
    // ... –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –ø–æ–ª—è –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Ç–∏–ø–∞
  },
  "tokens": {
    "accessToken": "eyJhbGciOiJIUzI1NiIs...",
    "refreshToken": "eyJhbGciOiJIUzI1NiIs..."
  },
  "success": true
}
```

#### –û—à–∏–±–∫–∏:
- **400** - –û—Ç—Å—É—Ç—Å—Ç–≤—É—é—Ç –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –ø–æ–ª—è
- **401** - –ù–µ–≤–µ—Ä–Ω—ã–µ —É—á–µ—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ

---

### 3. –ü–æ–ª—É—á–µ–Ω–∏–µ —Ç–µ–∫—É—â–µ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

**GET** `/api/auth/me`

–ü–æ–ª—É—á–µ–Ω–∏–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ —Ç–µ–∫—É—â–µ–º –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω–æ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ.

#### –ó–∞–≥–æ–ª–æ–≤–∫–∏:
```
Authorization: Bearer <accessToken>
```

#### –£—Å–ø–µ—à–Ω—ã–π –æ—Ç–≤–µ—Ç (200):
```json
{
  "user": {
    "id": "uuid",
    "email": "user@example.com",
    "name": "–ò–º—è –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è",
    "type": "client",
    // ... –ø–æ–ª–Ω—ã–π –ø—Ä–æ—Ñ–∏–ª—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
  },
  "success": true
}
```

#### –û—à–∏–±–∫–∏:
- **401** - –¢–æ–∫–µ–Ω –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç –∏–ª–∏ –Ω–µ–¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª–µ–Ω
- **404** - –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ –Ω–∞–π–¥–µ–Ω

---

### 4. –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ç–æ–∫–µ–Ω–∞

**POST** `/api/auth/refresh`

–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ access —Ç–æ–∫–µ–Ω–∞ —Å –ø–æ–º–æ—â—å—é refresh —Ç–æ–∫–µ–Ω–∞.

#### –¢–µ–ª–æ –∑–∞–ø—Ä–æ—Å–∞:
```json
{
  "refreshToken": "eyJhbGciOiJIUzI1NiIs..."
}
```

#### –£—Å–ø–µ—à–Ω—ã–π –æ—Ç–≤–µ—Ç (200):
```json
{
  "message": "–¢–æ–∫–µ–Ω—ã —É—Å–ø–µ—à–Ω–æ –æ–±–Ω–æ–≤–ª–µ–Ω—ã",
  "tokens": {
    "accessToken": "eyJhbGciOiJIUzI1NiIs...",
    "refreshToken": "eyJhbGciOiJIUzI1NiIs..."
  },
  "success": true
}
```

#### –û—à–∏–±–∫–∏:
- **400** - Refresh token –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç
- **401** - –ù–µ–¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã–π refresh token

---

### 5. –í—ã—Ö–æ–¥ –∏–∑ —Å–∏—Å—Ç–µ–º—ã

**POST** `/api/auth/logout`

–ó–∞–≤–µ—Ä—à–µ–Ω–∏–µ —Å–µ—Å—Å–∏–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.

#### –£—Å–ø–µ—à–Ω—ã–π –æ—Ç–≤–µ—Ç (200):
```json
{
  "message": "–£—Å–ø–µ—à–Ω—ã–π –≤—ã—Ö–æ–¥ –∏–∑ —Å–∏—Å—Ç–µ–º—ã",
  "success": true
}
```

---

## üîë JWT –¢–æ–∫–µ–Ω—ã

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ç–æ–∫–µ–Ω–∞:

```json
{
  "userId": "uuid",
  "email": "user@example.com",
  "type": "client",
  "iat": 1640995200,
  "exp": 1643587200,
  "iss": "nailmasters-api",
  "aud": "nailmasters-client"
}
```

### –í—Ä–µ–º—è –∂–∏–∑–Ω–∏:
- **Access Token**: 30 –¥–Ω–µ–π (–Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç—Å—è)
- **Refresh Token**: 90 –¥–Ω–µ–π

### –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:
–î–æ–±–∞–≤—å—Ç–µ access token –≤ –∑–∞–≥–æ–ª–æ–≤–æ–∫ Authorization:
```
Authorization: Bearer <accessToken>
```

---

## üõ°Ô∏è –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

### –í–∞–ª–∏–¥–∞—Ü–∏—è –ø–∞—Ä–æ–ª—è:
- –ú–∏–Ω–∏–º—É–º 8 —Å–∏–º–≤–æ–ª–æ–≤
- –ú–∞–∫—Å–∏–º—É–º 128 —Å–∏–º–≤–æ–ª–æ–≤
- –î–æ–ª–∂–µ–Ω —Å–æ–¥–µ—Ä–∂–∞—Ç—å —Ü–∏—Ñ—Ä—ã
- –î–æ–ª–∂–µ–Ω —Å–æ–¥–µ—Ä–∂–∞—Ç—å –±—É–∫–≤—ã

### –•–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ:
- –ê–ª–≥–æ—Ä–∏—Ç–º: bcrypt
- –†–∞—É–Ω–¥—ã: 12

### –ó–∞—â–∏—Ç–∞:
- –ü–∞—Ä–æ–ª–∏ –Ω–∏–∫–æ–≥–¥–∞ –Ω–µ –≤–æ–∑–≤—Ä–∞—â–∞—é—Ç—Å—è –≤ –æ—Ç–≤–µ—Ç–∞—Ö
- JWT –ø–æ–¥–ø–∏—Å—ã–≤–∞—é—Ç—Å—è —Å–µ–∫—Ä–µ—Ç–Ω—ã–º –∫–ª—é—á–æ–º
- –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –ø—Ä–∏ –∫–∞–∂–¥–æ–º –∑–∞–ø—Ä–æ—Å–µ

---

## üìù –ö–æ–¥—ã –æ—à–∏–±–æ–∫

| –ö–æ–¥ | –û–ø–∏—Å–∞–Ω–∏–µ |
|-----|----------|
| `MISSING_REQUIRED_FIELDS` | –û—Ç—Å—É—Ç—Å—Ç–≤—É—é—Ç –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –ø–æ–ª—è |
| `INVALID_EMAIL` | –ù–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç email |
| `INVALID_PASSWORD` | –ü–∞—Ä–æ–ª—å –Ω–µ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è–º |
| `INVALID_USER_TYPE` | –ù–µ–¥–æ–ø—É—Å—Ç–∏–º—ã–π —Ç–∏–ø –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è |
| `USER_ALREADY_EXISTS` | –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —É–∂–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç |
| `MISSING_CREDENTIALS` | –û—Ç—Å—É—Ç—Å—Ç–≤—É—é—Ç —É—á–µ—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ |
| `INVALID_CREDENTIALS` | –ù–µ–≤–µ—Ä–Ω—ã–µ —É—á–µ—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ |
| `NOT_AUTHENTICATED` | –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω |
| `NO_TOKEN` | –¢–æ–∫–µ–Ω –Ω–µ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª–µ–Ω |
| `INVALID_TOKEN` | –ù–µ–¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã–π —Ç–æ–∫–µ–Ω |
| `USER_NOT_FOUND` | –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ –Ω–∞–π–¥–µ–Ω |
| `MISSING_REFRESH_TOKEN` | –û—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç refresh token |
| `INVALID_REFRESH_TOKEN` | –ù–µ–¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã–π refresh token |
| `INTERNAL_SERVER_ERROR` | –í–Ω—É—Ç—Ä–µ–Ω–Ω—è—è –æ—à–∏–±–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞ |

---

## üß™ –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

### JavaScript/TypeScript:

```javascript
// –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è
const registerResponse = await fetch('/api/auth/register', {
  method: 'POST',
  headers: {
    'Content-Type': 'application/json',
  },
  body: JSON.stringify({
    email: 'user@example.com',
    password: 'securePassword123',
    name: '–ò–º—è –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è',
    phone: '+7 (999) 123-45-67',
    type: 'client'
  })
});

const { user, tokens } = await registerResponse.json();

// –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Ç–æ–∫–µ–Ω–æ–≤
localStorage.setItem('accessToken', tokens.accessToken);
localStorage.setItem('refreshToken', tokens.refreshToken);

// –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –∑–∞–ø—Ä–æ—Å
const profileResponse = await fetch('/api/auth/me', {
  headers: {
    'Authorization': `Bearer ${localStorage.getItem('accessToken')}`
  }
});
```

### cURL:

```bash
# –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è
curl -X POST http://localhost:3000/api/auth/register \
  -H "Content-Type: application/json" \
  -d '{
    "email": "user@example.com",
    "password": "securePassword123",
    "name": "–ò–º—è –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è",
    "phone": "+7 (999) 123-45-67",
    "type": "client"
  }'

# –í—Ö–æ–¥
curl -X POST http://localhost:3000/api/auth/login \
  -H "Content-Type: application/json" \
  -d '{
    "email": "user@example.com",
    "password": "securePassword123"
  }'

# –ü–æ–ª—É—á–µ–Ω–∏–µ –ø—Ä–æ—Ñ–∏–ª—è
curl -X GET http://localhost:3000/api/auth/me \
  -H "Authorization: Bearer <accessToken>"
``` 